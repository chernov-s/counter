# Тестовое задание "Counter"

Демонстрационная версия проекта находится по ссылке: [https://counter-frontend.firebaseapp.com](https://counter-frontend.firebaseapp.com)

Проект состоит из 2 частей:

-   Front-end часть
-   Back-end часть

# Структура проекта
![enter image description here](https://cdn1.imggmi.com/uploads/2019/6/2/cb8046918183e163349500b71a893e9d-full.jpg)

##  Front-end

Фронт энд часть разделена на модули, каждый модуль отвечает за определенный функционал. Так же, используется ленивая загрузка для модуля `DashboardModule`. 

## Модули

### AppModule

Является коневым модулем, в основном отвечает за связку компонентов и распределение на них различных сервисов из других модулей.

### AuthModule

Содержит компоненты для регистрации/авторизации пользователей и сервис, который является оберткой над `AngularFireAuth`. Так же, содержит гуард и интерцептор, которые используются в других частях приложения.

### SharedModule

Содержит полезные модули и компоненты для других модулей. Для избежания циклических зависимостей, они вынесены в отдельный модуль.
#### TextInputComponent
Следуя принципу [DRY](https://ru.wikipedia.org/wiki/Don%E2%80%99t_repeat_yourself) часто повторяющийся элемент - текстовый инпут - вынесен в отдельный компонент. Для настройки каждого конкретного инпута используются `@Input()` декораторы:

 - name. Имя контрола
 - [placeholder](https://developer.mozilla.org/ru/docs/Web/HTML/Element/Input#%D0%90%D1%82%D1%80%D0%B8%D0%B1%D1%83%D1%82%D1%8B)
 - form. Содержит имя переменной [FormGroup](https://angular.io/api/forms/FormGroup), с которой необходимо связать текущий контрол.
 - type. Содержит тип инпута, по умолчанию равен `text`.
 - errors. Содержит объект типа `[key:  string]:  string` связанный с формой `form`, в котором перечислены все `formErrors` указанной формы, 
#### SingleFormComponent
Универсальный компонент для наследования форм в проекте. В будущем может быть легко улучшен для отображения ошибок от сервера в полях формы.
##### `makeRequest:  Observable<any>`
Перезаписывается на Observable который содержит метод для обращения к сервису с хттп запросом принимающим форму.
##### `validationMessages: ValidationMessages` (`[key:  string]:  {[key:  string]:  string  }`)
Объект содержащий текстовые описания для всех фронтэнд ошибок у каждого из контролов формы.
##### `formFields: FormFields` (`[key:  string]:  ValidatorFn|ValidatorFn[]`)
Содержит поля формы и валидаторы которые необходимо к ним применить.
##### `getFormModel()`
Метод предназначенный для генерации формы на основе объекта `formFields`, в котором описаны все поля и валидаторы для них. Выполняется во время`ngOnInit()` в компоненте наследующей формы.
##### `initErrors()`
Метод, вызываемый на `ngOnInit()` наследующей формы, является механизмом связывающим `validationMessages` и `formFields`.
##### `makeMessage()`
Метод используемый для создания текста ошибки из свойства `errors` переданного контрола.
#### `updateValidationMessages()`
Метод для обновления состояния формы. Делает формы более отзывчивыми.
##### `isControlHasErrors()`
Шорткат метод для определения валидности\не валидности переданного контрола.
##### `submitForm()`
Метод отвечающий за отправку формы. Запрос составляется на основе наблюдаемого в `makeRequest`. Так же устанавливает статус обработки для формы.
##### `onSubmitSuccess()`
Коллбэк для обработки успешного ответа от сервера.
##### `onSubmitFail()`
Коллбэк для обработки не успешного ответа от сервера.

### DashboardModule
Основной модуль приложения, содержит сервис `DashboardService` с методами для получения данных  `getCounter()`о счётчике и его приросту `incrementCounter()`, вьюху `IncrementCounterComponent` для отрисовки счётчика и диалоговое окно `IncrementDialogComponent` с интерфейсом для пользователя. 

# ToDo если бы это был реальный проект

 - [trackBy](https://angular.io/api/core/TrackByFunction) на всех `*ngFor`
 - [onPush](https://angular.io/api/core/ChangeDetectionStrategy) на всех компонентах без исключения
 - [PreloadAllModules](https://angular.io/api/router/PreloadAllModules) для загрузки лейзи лоадинг компонентов
 - [favicon](https://realfavicongenerator.net/)
 - [e2e](https://www.protractortest.org)
 - [перфоманс](https://github.com/mgechev/angular-performance-checklist/blob/master/README.ru-RU.md)
 
## [ngxs](https://ngxs.gitbook.io/ngxs/)  стейт менеджер
Служит двум целям: кеширование (для увелечения быстроты отклика интерфейса и уменьшения количества запросов на сервер) и упрощения обмена данными которые не могут быть прокинуты через `@Input()` \ `@Output()` между компонентами. Например:
1. Данные авторизированного пользователя не будут меняться в течении всей сессии, по этому такие данные имеет смысл закешировать. 
2. Ошибки могут быть локальными (например ошибки валидации инпута) и глобальные (ошибка удаления файла из списка). Удобно иметь модуль, который бы отвечал за сохранение и отображение глобальных ошибок и вызывался одним экшеном из любой части приложения.